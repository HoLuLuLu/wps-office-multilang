<html>
<script src="../../../css/help.js" >
</script>
<head>
<link rel="stylesheet" href="../../../css/style.css" type="text/css">
<link rel="stylesheet" href="../../../css/styleOfTable.css" type="text/css">
<meta http-equiv="Content-Language" content="zh-cn">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">


<title>SUBTOTAL</title>
<object type="application/x-oleobject" classid="clsid:1e2gbd0-dab9-11d0-b93a-00c04fc99f9e">
  <param name="Keyword" value="SUBTOTAL">
  <param name="Keyword" value="函数">
</object>
</head>

<body bgcolor="#FFFFFF">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; position: absolute; left: 0; top: 0; margin: 0" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="50%">
    <img border="0" src="../../../images/Ribbon/title1.gif" width="312" height="69"></td>
    <td width="50%">
    <p align="right">
    <img border="0" src="../../../images/Ribbon/logo.gif" width="120" height="26"></td>
  </tr>
</table>
<p>　</p>
<p>　</p>
<h1>SUBTOTAL</h1>
<p>返回数据清单或数据库中的分类汇总。通常，使用“数据”菜单中的“分类汇总”命令可以容易地创建带有分类汇总的数据清单。一旦创建了分类汇总，就可以通过编辑 SUBTOTAL 函数对该数据清单进行修改。</p>
<p><b>语法</b></p>
<p><b>SUBTOTAL（function_num,ref1,ref2,...）</b></p>
<p>Function_num&nbsp;&nbsp;&nbsp;&nbsp;为 1 到 11 之间的数字，指定使用何种函数在数据清单中进行分类汇总计算。</p>

<table width="357">
	<tr>
		<th class ="thEmpty"></td>
		<th class ="th1" width="202">Function_num</th>
		<th class ="th2">函数</th>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">1</td>
		<td class ="ll">AVERAGE</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">2</td>
		<td class ="ll">COUNT</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">3</td>
		<td class ="ll">COUNTA</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">4</td>
		<td class ="ll">MAX</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">5</td>
		<td class ="ll">MIN</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">6</td>
		<td class ="ll">PRODUCT</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">7</td>
		<td class ="ll">STDEV</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">8</td>
		<td class ="ll">STDEVP</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">9</td>
		<td class ="ll">SUM</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">10</td>
		<td class ="ll">VAR</td>
	</tr>
	<tr>
		<td class ="ll"></td>
		<td class ="ll">11</td>
		<td class ="ll">VARP</td>
	</tr>
</table>

<p>Ref1, ref2,&nbsp;&nbsp;&nbsp;&nbsp;为要进行分类汇总计算的 1 到 29 个区域或引用。</p>
<p><b>说明</b></p>
<ul>
	<li>如果在 ref1, ref2,… 中有其他的分类汇总（嵌套分类汇总），将忽略这些嵌套分类汇总，以避免重复计算。</li>
	<li>函数 SUBTOTAL 将忽略由数据清单筛选时产生的任何隐藏行。在需要对筛选过的数据清单中的可见数据进行分类汇总时，需要注意。</li>
	<li>如果所指定的某一引用为三维引用，函数 SUBTOTAL 将返回错误值 #VALUE!。</li>
</ul>
<p><b>示例</b></p>
<p>如果将示例复制到空白工作表中，可能会更易于理解该示例。</p>
<table>
	<tr>
		<th class ="thEmpty"></th>
		<th class ="th1">A</th>
	</tr>
	<tr>
		<td class ="tdSeqence">1</td>
		<td class ="th1">数据</td>
	</tr>
	<tr>
		<td class ="tdSeqence">2</td>
		<td class ="ll">120</td>
	</tr>
	<tr>
		<td class ="tdSeqence">3</td>
		<td class ="ll">10</td>
	</tr>
	<tr>
		<td class ="tdSeqence">4</td>
		<td class ="ll">150</td>
	</tr>
	<tr>
		<td class ="tdSeqence">5</td>
		<td class ="ll">23</td>
	</tr>
</table>
<br>
<table>

	<tr>
		<td class ="thEmpty"></td>
		<td class = "th1"><b>公式</b></td>
		<td class = "th2"><b>说明（结果）</b></td>
	</tr>
	<tr>
		<td></td>
		<td class ="ll">=SUBTOTAL(9,A2:A5)</td>
		<td class ="ll">对上面列使用 SUM 函数计算出的分类汇总 (303)</td>
	</tr>
	<tr>
		<td></td>
		<td class ="ll">=SUBTOTAL(1,A2:A5)</td>
		<td class ="ll">对上面列使用 AVERAGE 函数计算出的分类汇总 (75.75)</td>
	</tr>
</table>



<p>　</p>
<p><b>相关功能</b></p>
<p><a href="functionlist_Math.htm">数学与三角函数</a></p>



</body>

</html>