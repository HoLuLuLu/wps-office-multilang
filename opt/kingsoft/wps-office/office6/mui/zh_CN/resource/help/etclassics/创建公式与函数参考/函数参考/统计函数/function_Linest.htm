<html>
<script src="../../../css/help.js" >
</script>
<head>
<link rel="stylesheet" href="../../../css/style.css" type="text/css">
<link rel="stylesheet" href="../../../css/styleOfTable.css" type="text/css">

<meta http-equiv="Content-Language" content="zh-cn">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">


<title>LINEST</title>
<object type="application/x-oleobject" classid="clsid:1e2gbd0-dab9-11d0-b93a-00c04fc99f9e">
  <param name="Keyword" value="LINEST">
  <param name="Keyword" value="函数">
</object>
</head>

<body bgcolor="#FFFFFF">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; position: absolute; left: 0; top: 0; margin: 0" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="50%">
    <img border="0" src="../../../images/title1.gif" width="312" height="69"></td>
    <td width="50%">
    <p align="right">
    <img border="0" src="../../../images/logo.gif" width="120" height="26"></td>
  </tr>
</table>
<p>　</p>
<p>　</p>
<h1>LINEST</h1>
<p>使用最小二乘法对已知数据进行最佳直线拟合，并返回描述此直线的数组。因为此函数返回数值数组，所以必须以数组公式的形式输入。<br>
<br>
直线的公式为：<br>
<br>
y = mx + b 或者<br>
<br>
y = m1x1 + m2x2 + ... + b（如果有多个区域的 x 值）<br>
<br>
式中，因变量 y 是自变量 x 的函数值。M 值是与每个 x 值相对应的系数，b 为常量。注意 y、x 和 m 可以是向量。LINEST 函数返回的数组为 
{mn,mn-1,...,m1,b}。LINEST 函数还可返回附加回归统计值。<br>
</p>
<p><b>语法</b></p>
<p><b>LINEST</b>(<b>known_y's</b>,known_x's,const,stats)</p>
<p>Known_y's&nbsp;&nbsp; 是关系表达式 y = mx + b 中已知的 y 值集合。 </p>
<ul>
	<li>
	<p>如果数组 known_y's 在单独一列中，则 known_x's 的每一列被视为一个独立的变量。 </li>
	<li>
	<p>如果数组 known-y's 在单独一行中，则 known-x's 的每一行被视为一个独立的变量。 </li>
</ul>
<p>Known_x's&nbsp;&nbsp; 是关系表达式 y = mx + b 中已知的可选 x 值集合。 </p>
<ul>
	<li>
	<p>数组 known_x's 可以包含一组或多组变量。如果只用到一个变量，只要 known_y's 和 known_x's 
	维数相同，它们可以是任何形状的区域。如果用到多个变量，则 known_y's 必须为向量（即必须为一行或一列）。 </li>
	<li>
	<p>如果省略 known_x's，则假设该数组为 {1,2,3,...}，其大小与 known_y's 相同。 </li>
</ul>
<p>Const&nbsp;&nbsp; 为一逻辑值，用于指定是否将常量 b 强制设为 0。 </p>
<ul>
	<li>
	<p>如果 const 为 TRUE 或省略，b 将按正常计算。 </li>
	<li>
	<p>如果 const 为 FALSE，b 将被设为 0，并同时调整 m 值使 y = mx。 </li>
</ul>
<p>Stats&nbsp;&nbsp; 为一逻辑值，指定是否返回附加回归统计值。 </p>
<ul>
	<li>
	<p>如果 stats 为 TRUE，则 LINEST 函数返回附加回归统计值，这时返回的数组为 
	{mn,mn-1,...,m1,b;sen,sen-1,...,se1,seb;r2,sey;F,df;ssreg,ssresid}。 </li>
	<li>
	<p>如果 stats 为 FALSE 或省略，LINEST 函数只返回系数 m 和常量 b。 </li>
</ul>
<p>附加回归统计值如下：</p>

<table>
	<tr>
		<td class = "th1">统计值</td>
		<td class = "th1">说明</td>
	</tr>
	<tr>
		<td class="ll">se1,se2,...,sen</td>
		<td class="ll">系数 m1,m2,...,mn 的标准误差值。</td>
	</tr>
	<tr>
		<td class="ll">Seb</td>
		<td class="ll">常量 b 的标准误差值（当 const 为 FALSE时，seb = #N/A）</td>
	</tr>
	<tr>
		<td class="ll">r2</td>
		<td class="ll">判定系数。Y 的估计值与实际值之比，范围在 0 到 1 之间。如果为 1，则样本有很好的相关性，Y 
		的估计值与实际值之间没有差别。如果判定系数为 0，则回归公式不能用来预测 Y 值。有关计算 r2 的方法的详细信息，请参阅本主题后面的“说明”。</td>
	</tr>
	<tr>
		<td class="ll">sey</td>
		<td class="ll">Y 估计值的标准误差。</td>
	</tr>
	<tr>
		<td class="ll">F</td>
		<td class="ll">F 统计或 F 观察值。使用 F 统计可以判断因变量和自变量之间是否偶尔发生过可观察到的关系。</td>
	</tr>
	<tr>
		<td class="ll">df</td>
		<td class="ll">自由度。用于在统计表上查找 F 临界值。所查得的值和 LINEST 函数返回的 F 
		统计值的比值可用来判断模型的置信度。</td>
	</tr>
	<tr>
		<td class="ll">ssreg</td>
		<td class="ll">回归平方和。</td>
	</tr>
	<tr>
		<td class="ll">ssresid</td>
		<td class="ll">残差平方和。</td>
	</tr>
	
</table>

<div border="0">
	<p>下面的图示显示了附加回归统计值返回的顺序。</p>
	<p><img border="0" src="../../../images/function_Linest3.gif" width="315" height="89"></p>
	<p><b>说明</b> </p>
	<ul>
		<li>可以使用斜率和 y 轴截距描述任何直线： 
		<p>斜率 (m)：<br>
		通常记为 m，如果需要计算斜率，则选取直线上的两点，(x1,y1) 和 (x2,y2)。斜率等于 (y2 - y1)/(x2 - x1)。 
		</p>
		<p>Y 轴截距 (b)：<br>
		通常记为 b，直线的 y 轴的截距为直线通过 y 轴时与 y 轴交点的数值。 </p>
		<p>直线的公式为 y = mx + b。如果知道了 m 和 b 的值，将 y 或 x 
		的值代入公式就可计算出直线上的任意一点。</li>
		<li>当只有一个自变量 x 时，可直接利用下面公式得到斜率和 y 轴截距值： 
		<p>斜率：<br>
		=INDEX(LINEST(known_y's,known_x's),1) </p>
		<p>Y 轴截距：<br>
		=INDEX(LINEST(known_y's,known_x's),2) </li>
		<li>数据的离散程度决定了 LINEST 函数计算的精确度。数据越接近线性，LINEST 模型就越精确。LINEST 
		函数使用最小二乘法来判定最适合数据的模型。当只有一个自变量 x 时，m 和 b 是根据下面的公式计算出的： 
		<p>
		<img border="0" src="../../../images/function_Linest1.gif" width="172" height="52"></p>
		<p>
		<img border="0" src="../../../images/function_Linest2.gif" width="224" height="52"></p>
		<p>　</li>
		<li>直线和 LINEST 
		可用来计算与给定数据拟合程度最高的直线。这些不带参数 new_x's 的函数可在实际数据点上根据直线来返回 y 
		的数组值，然后可以将预测值与实际值进行比较。还可以用图表方式来直观地比较二者。 
		</li>
		<li>回归分析时，WPS表格 计算每一点的 y 
		的估计值和实际值的平方差。这些平方差之和称为残差平方和。然后WPS表格计算 y 
		的实际值和平均值的平方差之和。称为总平方和（回归平方和 + 残差平方和）。残差平方和与总平方和的比值越小，判定系数 r2 的值就越大，r2 
		是表示回归分析公式的结果反映变量间关系的程度的标志。 
		</li>
		<li>对于返回结果为数组的公式，必须以数组公式的形式输入。 
		</li>
		<li>当需要输入一个数组常量（如 known_x's）作为参数时，以逗号作为同一行中数据的分隔符，以分号作为不同行数据的分隔符。分隔符可能因“<b class="UI" name="regionalsettings">区域设置</b>”中或“<b class="UI" name="controlpanel">控制面板</b>”的“<b class="UI" name="regionaloptions">区域选项</b>”中区域设置的不同而有所不同。 
		</li>
		<li>注意，如果 y 的回归分析预测值超出了用来计算公式的 y 值的范围，它们可能是无效的。 </li>
	</ul>
	<p>　</p>
	<p>如果您将示例复制到空白工作表中，可能会更易于理解该示例。</p>
	<p><b>示例 1&nbsp;&nbsp; 斜率和 Y 轴截距 </b></p>

<table>
	<tr>
		<th class="thEmpty"></th>
	    <th class="th1">A</th>
	    <th class="th1">B</th>
	</tr>
	<tr>
		<td class="tdSeqence"><b>1</b></td>
		<td class = "th1">已知 y</td>
		<td class = "th1">已知 x</td>
	</tr>
	<tr>
		<td class="tdSeqence"><b>2</b></td>
		<td class="ll">1</td>
		<td class="ll">0</td>
	</tr>
	<tr>
		<td class="tdSeqence">3</td>
		<td class="ll">9</td>
		<td class="ll">4</td>
	</tr>

	<tr>
		<td class="tdSeqence">4</td>
		<td class="ll">5</td>
		<td class="ll">2</td>
	</tr>

	<tr>
		<td class="tdSeqence">5</td>
		<td class="ll">6</td>
		<td class="ll">3</td>
	</tr>

</table>

<br>

<table>

	<tr>
		<td class ="tdEmpty" ></td>
		<td class = "th1"><b>公式</b></td>
		<td class = "th2" width="146"><b>说明（结果）</b></td>
	</tr>
	<tr>
		<td class ="tdEmpty">　</td>
		<td class="ll">=LINEST(A2:A5,B2:B5,,FALSE)</td>
		<td class="ll">返回斜率 (2)</td>
	</tr>
	<tr>
		<td class ="tdEmpty">　</td>
		<td class="ll">=INDEX(LINEST(A2:A5,B2:B5,,FALSE),2)</td>
		<td class="ll">返回截距 (1)</td>
	</tr>
	</table>



<p><b>提示&nbsp;&nbsp; </b>示例中的公式也可以以数组公式输入。在将公式复制到一张空白工作表的A7单元格后，选择以公式单元格开始的区域 A7:B7。按 
F2，再按 Ctrl+Shift+Enter。</p>
<p><b>示例 2&nbsp;&nbsp; 简单线性回归</b></p>

<table>
	<tr>
		<th class="thEmpty"></th>
	    <th class="th1">A</th>
	    <th class="th1">B</th>
	</tr>
	<tr>
		<td class="tdSeqence"><b>1</b></td>
		<td class = "th1">月</td>
		<td class = "th1">销售</td>
	</tr>
	<tr>
		<td class="tdSeqence"><b>2</b></td>
		<td class="ll">1</td>
		<td class="ll">3100</td>
	</tr>
	<tr>
		<td class="tdSeqence">3</td>
		<td class="ll">2</td>
		<td class="ll">4500</td>
	</tr>

	<tr>
		<td class="tdSeqence">4</td>
		<td class="ll">3</td>
		<td class="ll">4400</td>
	</tr>
	<tr>
		<td class="tdSeqence">5</td>
		<td class="ll">4</td>
		<td class="ll">5400</td>
	</tr>

	<tr>
		<td class="tdSeqence">6</td>
		<td class="ll">5</td>
		<td class="ll">7500</td>
	</tr>

	<tr>
		<td class="tdSeqence">7</td>
		<td class="ll">6</td>
		<td class="ll">8100</td>
	</tr>

	</table>

<br>

<table>

	<tr>
		<td class ="tdEmpty" ></td>
		<td class = "th1"><b>公式</b></td>
		<td class = "th2" width="146"><b>说明（结果）</b></td>
	</tr>
	<tr>
		<td class ="tdEmpty">　</td>
		<td class="ll">=SUM(LINEST(B2:B7, A2:A7)*{9,1})</td>
		<td class="ll">估算第 9 个月的销售值 (11000)</td>
	</tr>
	</table>



<p>通常，SUM({m,b}*{x,1}) 等于 mx + b，即给定 x 值的 y 的估计值。</p>
	<p><b>示例 3&nbsp;&nbsp; 多重线性回归</b></p>
	<p>假设有开发商正在考虑购买商业区里的一组小型办公楼。</p>
	<p>开发商可以根据下列变量，采用多重线性回归的方法来估算给定地区内的办公楼的价值。</p>

<table>

	<tr>
		<td class = "th1">变量</td>
		<td class = "th2" width="146">代表</td>
	</tr>
	<tr>
		<td class="ll">y</td>
		<td class="ll">办公楼的评估值</td>
	</tr>
	<tr>
		<td class="ll">x1</td>
		<td class="ll">底层面积（平方英尺）</td>
	</tr>
	<tr>
		<td class="ll">x2</td>
		<td class="ll">办公室的个数</td>
	</tr>
	<tr>
		<td class="ll">x3</td>
		<td class="ll">入口个数</td>
	</tr>
	<tr>
		<td class="ll">x4</td>
		<td class="ll">办公楼的使用年数</td>
	</tr>
	</table>
	<p>本示例假设在自变量（x1、x2、x3 和 x4）和因变量 (y) 之间存在线性关系。其中 y 是办公楼的价值。</p>
	<p>开发商从 1,500 个可选的办公楼里随机选择了 11 个办公楼作为样本，得到下列数据。“半个入口”指的是运输专用入口。</p>

<table>
	<tr>
		<th class="thEmpty"></th>
	    <th class="th1">A</th>
	    <th class="th1">B</th>
	    <th class="th1">C</th>
	    <th class="th1">D</th>
	    <th class="th1">E</th>
	</tr>
	<tr>
		<td class="tdSeqence"><b>1</b></td>
		<td class = "th1">底层面积 (x1)</td>
		<td class = "th1">办公室的个数 (x2)</td>
		<td class = "th1">入口个数 (x3)</td>
		<td class = "th1">办公楼的使用年数 (x4)</td>
		<td class = "th1">办公楼的评估值 (y)</td>
	</tr>
	<tr>
		<td class="tdSeqence">2</td>
		<td class="ll">2310</td>
		<td class="ll">2</td>
		<td class="ll">2</td>
		<td class="ll">20</td>
		<td class="ll">142,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">3</td>
		<td class="ll">2333</td>
		<td class="ll">3</td>
		<td class="ll">2</td>
		<td class="ll">12</td>
		<td class="ll">144,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">4</td>
		<td class="ll">2356</td>
		<td class="ll">4</td>
		<td class="ll">1.5</td>
		<td class="ll">33</td>
		<td class="ll">151,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">5</td>
		<td class="ll">2379</td>
		<td class="ll">4</td>
		<td class="ll">2</td>
		<td class="ll">43</td>
		<td class="ll">150,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">6</td>
		<td class="ll">2402</td>
		<td class="ll">2</td>
		<td class="ll">3</td>
		<td class="ll">53</td>
		<td class="ll">139,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">7</td>
		<td class="ll">2425</td>
		<td class="ll">4</td>
		<td class="ll">2</td>
		<td class="ll">23</td>
		<td class="ll">169,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">8</td>
		<td class="ll">2448</td>
		<td class="ll">2</td>
		<td class="ll">1.5</td>
		<td class="ll">99</td>
		<td class="ll">126,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">9</td>
		<td class="ll">2471</td>
		<td class="ll">2</td>
		<td class="ll">2</td>
		<td class="ll">34</td>
		<td class="ll">142,900</td>
	</tr>

	<tr>
		<td class="tdSeqence">10</td>
		<td class="ll">2494</td>
		<td class="ll">3</td>
		<td class="ll">3</td>
		<td class="ll">23</td>
		<td class="ll">163,000</td>
	</tr>
	<tr>
		<td class="tdSeqence">11</td>
		<td class="ll">2517</td>
		<td class="ll">4</td>
		<td class="ll">4</td>
		<td class="ll">55</td>
		<td class="ll">169,000</td>
	</tr>

	<tr>
		<td class="tdSeqence">12</td>
		<td class="ll">2540</td>
		<td class="ll">2</td>
		<td class="ll">3</td>
		<td class="ll">22</td>
		<td class="ll">149,000</td>
	</tr>

	</table>

	<br>

<table>

	<tr>
		<td class ="tdEmpty" >
		<p></td>
		<td class = "th1"><b>公式</b></td>
	</tr>
	<tr>
		<td class ="tdEmpty">　</td>
		<td class="ll">=LINEST(E2:E12,A2:D12,TRUE,TRUE)</td>
	</tr>
	</table>



	<p><b>注意&nbsp;&nbsp; </b>示例中的公式必须以数组公式输入。在将公式复制到一张空白工作表后，选择以公式单元格开始的区域 A14:E18。按 F2，再按 
	Ctrl+Shift+Enter。如果公式不是以数组公式输入，则返回单个结果值 -234.2371645。</p>
	<p>当作为数组输入时，将返回下面的回归统计值，可用该值可识别所需的统计值。</p>
	<p><img border="0" src="../../../images/function_Linest3.gif" width="315" height="89"></p>
	<p>多重回归公式，y = m1*x1 + m2*x2 + m3*x3 + m4*x4 + b，可通过第 14 行的值得到：</p>
	<p>y = 27.64*x1 + 12,530*x2 + 2,553*x3+ 234.24*x4 + 52,318</p>
	<p>现在，开发商用下面公式可得到办公楼的评估价值，其中面积为 2,500 平方英尺、3 个办公室、2 个入口，已使用 25 年：</p>
	<p>y = 27.64*2500 + 12530*3 + 2553*2 - 234.24*25 + 52318 = 
	$158,261</p>
	<p>或者，可将下表复制到示例工作簿的单元格 A21。</p>

<table>
	<tr>
		<td class = "th1">底层面积 (x1)</td>
		<td class = "th1">办公室的个数 (x2)</td>
		<td class = "th1">入口个数 (x3)</td>
		<td class = "th1">办公楼的使用年数 (x4)</td>
		<td class = "th1">办公楼的评估值 (y)</td>
	</tr>
	<tr>
		<td class="ll">2500</td>
		<td class="ll">3</td>
		<td class="ll">2</td>
		<td class="ll">25</td>
		<td class="ll">=D14*A22 + C14*B22 + B14*C22 + A14*D22 + E14</td>
	</tr>

	</table>

	<p><b>示例 4&nbsp;&nbsp; 使用 F 和 R2 统计</b></p>
	<p>在上例中，判定系数（或 r2）为 0.99675（函数 LINEST 的输出单元格 A17 
	中的值），表明在自变量与销售价格之间存在很大的相关性。可以通过 F 统计来确定具有如此高的 r2 值的结果偶然发生的可能性。</p>
	<p>假设事实上在变量间不存在相关性，但选用 11 
	个办公楼作为小样本进行统计分析却导致很强的相关性。术语“Alpha”表示得出这样的相关性结论错误的概率。</p>
	<p>如果 F 观测统计值大于 F 临界值，表明变量间存在相关性。F 临界值可以从许多的统计类书籍的 F 
	统计临界值表中查到。如果一项单尾实验的 Alpha 值为 0.05，自由度（在大多数表中缩写成 v1 和 v2）v1 = k = 4，v2 = N - 
	(k + 1) = 11 - (4 + 1) = 6，其中 k 是回归分析中的变量个数，n 是数据点的个数。F 临界值为 4.53。</p>
	<p>F 观测值为 459.753674（单元格 A18 中），远大于 F 临界值 
	4.53。因此回归公式可用来对该地区的办公楼进行评估。</p>
	<p><b>示例 5&nbsp;&nbsp; 计算 T 统计</b></p>
	<p>另一个假设检验可以检验示例中的每个斜率系数是否可以用来估算示例 3 
	中的办公楼的评估价值。例如，如果要检验年数系数的统计显著水平，用 13.268（单元格 A15 里的年数系数的估算标准误差）去除 
	-234.24（年数斜率系数）。下面是 T 观察值：</p>
	<p>t = m4 ÷ se4 = -234.24 ÷ 13.268 = -17.7</p>
	<p>如果查阅统计手册里的表格，将会发现：单尾、自由度为 6、Alpha = 0.05 的 t 临界值为 1.94。既然 t 
	的绝对值为 17.7，大于 1.94，则年数对于估算办公楼的评估价值来说是一个显著变量。用同样方法，可以测试自变量的统计显著水平。下面是每个自变量的 t 
	观察值。</p>

<table>

	<tr>
		<td class = "th1">变量</td>
		<td class = "th2" width="146">t 观察值</td>
	</tr>
	<tr>
		<td class="ll">底层面积</td>
		<td class="ll">5.1</td>
	</tr>
	<tr>
		<td class="ll">办公室个数</td>
		<td class="ll">31.3</td>
	</tr>
	<tr>
		<td class="ll">入口个数</td>
		<td class="ll">4.8</td>
	</tr>
	<tr>
		<td class="ll">使用年数</td>
		<td class="ll">17.7</td>
	</tr>
	</table>
	<p>这些值的绝对值都大于 1.94。因此，回归公式的所有变量都可用来估算区域内的办公楼的评估价值。</p>
	<p>　</p>
	<p><b>相关功能</b></p>
<p><a href="functionlist_stat.htm">统计函数</a></p>



</body>

</html>